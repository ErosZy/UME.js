(function(g,h){var d=g,c=h,e={};var i={},b=[],f={},a=[];e.define=function(){var w=this,k=arguments.length,r=0,u,l,q,s,x,p,j,n;if(k<=2){l=[];u=w._is("Function",arguments[1])?arguments[1]:function(){}}else{l=w._is("Array",arguments[1])?arguments[1]:[];u=w._is("Function",arguments[2])?arguments[2]:function(){}}n=w._parse(u);if(n){l=l.concat(n.requires);u=n.fn}x=w._toPath(arguments[0]);for(p=0,s=l.length;p<s;p++){l[p]=w._toPath(l[p]);f[l[p]]=f[l[p]]?f[l[p]]:[];f[l[p]].push(t)}q=w._getRequireModulesInfo(l);s=q.length;for(p=0;p<s;p++){b.push(q[p])}j=w._hasLoadingModules(l);if(!s){if(j){a.push(v);return}var m=w._getModulesInstance(l),o=u.apply(w,m);i[x]=o;w._emitAll()}else{a.push(v);for(p=0;p<s;p++){w._load(q[p],function(){w._emitProxy(l);w._emitAll()})}}function t(){r++}function v(){var z,y;if(r<s){return false}z=w._getModulesInstance(l);if(z.length!=l.length){return false}w._clearProxy(l);y=u.apply(w,z);i[x]=y;return true}};e.use=function(k){var j=this;if(j._is("String",k)){k=j._toPath(k);j._load(k)}else{throw new Error("the param path is needed,please check your function caller param!")}};e._getRequireModulesInfo=function(k){var m=this,p=[],o,j;for(o=0,j=k.length;o<j;o++){var n=k[o],l=n in i||m._getLoadingIndex(n)!=-1;if(!l){p.push(n)}}return p};e._getModulesInstance=function(l){var k=this,n=[];for(var m=0,j=l.length;m<j;m++){if(l[m] in i){n.push(i[l[m]])}}return n};e._emitAll=function(){var k=this,j=false;for(var l=a.length-1;l>=0;l--){j=a[l]&&a[l].apply(k);if(j){a.splice(l,1)}}if(!b.length&&a.length){k._emitAll()}};e._emitProxy=function(n){var l=this,q;for(var o=0,k=n.length;o<k;o++){q=f[n[o]];for(var m=0,p=q.length;m<p;m++){if(q[m]){q[m].apply(l);f[n[o]][m]=null}}}};e._clearProxy=function(n){var l=this,q;for(var o=0,k=n.length;o<k;o++){q=f[n[o]];for(var m=0,p=q.length;m<p;m++){if(!q[m]){q.splice(m,1);p--;m--}}}};e._getLoadingIndex=function(n){var k=this,l=-1;for(var m=0,j=b.length;m<j;m++){if(b[m]==n){l=m}}return l};e._hasLoadingModules=function(n){var l=this,q;for(var o=0,k=n.length;o<k;o++){q=n[o];for(var m=0,p=b.length;m<p;m++){if(q==b[m]){return true}}}return false};e._parse=function(p){var l=this,k=p.toString(),o=/self.use\((["'])(.+?)\1\);?/g,n=[],q=[];if(!o.test(k)){return}k=l._clearNotes(k);k=k.replace(/self.use\((["'])(.+?)\1\);?/g,function(){var s=arguments[2],t=s.lastIndexOf("/"),u=s.lastIndexOf("."),r=s.slice(t+1).slice(0,u-2);r+=+new Date();n.push(s);q.push(r);return r});k=k.replace(/function\s*\((.*?)\)/,function(){q.unshift(arguments[1]);return"function()"});for(var m=0,j=q.length;m<j;m++){if(!q[m]){q.splice(m,1)}}q=q.join(",");p=new Function(q,"return ("+k+"());");return{requires:n,fn:p}};e._clearNotes=function(j){var k=this;j=j.replace(/\/\/.*|\/\*.*\*\//g,"");return j};e._on=function(n,k,l){var j=this,m=k+l.toString().replace(/\s+/g,"");n[k]=n[k]?n[k]:{};n[k][m]=l;if(document.attachEvent){n.attachEvent("on"+k,function(o){l.call(n,o)})}else{if(document.addEventListener){n.addEventListener(k,l,false)}else{n["on"+k]=n.eventName[m]}}};e._load=function(p,o){var l=this,n=document.attachEvent?true:false,j=document.getElementsByTagName("body")[0],k,m;k=document.createElement("script");k.src=p;if(n){l._on(k,"readystatechange",function(){if(k.readyState=="complete"){m=l._getLoadingIndex(p);if(m!=-1){b.splice(m,1)}if(l._is("Function",o)){o.apply(l)}}})}else{l._on(k,"load",function(){m=l._getLoadingIndex(p);if(m!=-1){b.splice(m,1)}if(l._is("Function",o)){o.apply(l)}})}j.appendChild(k)};e._toPath=function(t){var s=this,q=d.location,r=q.protocol,p=q.hostname,n=q.port?":"+q.port:"",l=q.pathname,k=q.href,m=/^(\/.+\/)/i,j,o;if(m.test(l)){j=r+"//"+p+n+RegExp["$1"]+t}else{o=k.lastIndexOf("/");j=k.slice(0,o)+t}return j};e._is=function(j,k){return Object.prototype.toString.call(k)=="[object "+j+"]"};g.UME=e}(window));